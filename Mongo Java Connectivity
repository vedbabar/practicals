package assignment_8;

import java.util.*;
import org.bson.Document;
import com.mongodb.MongoClient;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;

public class MongoCRUDSimple {
	public static void main(String [] args) {
    MongoClient client=new MongoClient("127.0.0.1",27017);
    MongoDatabase db=client.getDatabase("students");
    MongoCollection<Document> coll=db.getCollection("students");
    
    Scanner sc=new Scanner(System.in);
    int choice;
    do {
    	System.out.println("\n---MENU---");
    	System.out.println("1.Insert");
    	System.out.println("2.Display");
    	System.out.println("3.Update");
    	System.out.println("4.Delete");
    	System.out.println("5.Exit");
    	
    	choice=sc.nextInt();
    	switch(choice) {
    	case 1:
    		System.out.print("Enter name: ");
    		String name=sc.next();
    		System.out.print("Enter age: ");
    		int age=sc.nextInt();    		
    		Document doc=new Document("name",name).append("age",age);
    		coll.insertOne(doc);
    		System.out.println("Record inserted !!");
    		break;
    	case 2:
    		System.out.println("All Documents: ");
    		for(Document d:coll.find()) {
    			System.out.println(d.toJson());
    		}
    		break;
    	case 3:
    		System.out.print("Enter name to update: ");
    		String oldName=sc.next();
    		System.out.print("Enter new age: ");
    		int newAge=sc.nextInt(); 
    		coll.updateOne(new Document("name",oldName),new Document("$set",new Document("age",newAge)));
    		System.out.println("Record updated !!");
    		break;
    	case 4:
    		System.out.print("Enter name to delete: ");
    		String delName=sc.next();
    		coll.deleteOne(new Document("name",delName));
    		System.out.println("Record deleted !!");
    	case 5:
    		System.out.println("Exiting !!");
    		break;
    	default:
    		System.out.println("Invalid choice !");
    	}
    }while(choice!=5);
    
    sc.close();
    client.close();
}
}
